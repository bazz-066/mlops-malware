from util.util import EVENT_KEY_MAPPING

class EventLog():
    def __init__(self) -> None:
        self.target_file_name = None
        self.target_process_guid = None
        self.event_type = None
        self.target_image = None
        self.destination_host_name = None
        self.company = None
        self.description = None
        self.product = None
        self.integrity_level = None
        self.logon_id = None
        self.parent_process_guid = None
        self.terminal_session_id = None
        self.parent_process_id = None
        self.target_object = None
        self.previous_creation_utc_time = None
        self.creation_utc_time = None
        self.start_function = None
        self.user = None
        self.rule_name = None
        self.event_id = None

        # processed data
        self.label = None

        # addition
        self.process_id = None
        self.system_time_created = None
        self.event_record_id = None

    def map_event_key(self, key):
        try:
            return EVENT_KEY_MAPPING[key]
        except:
            return None

    def get_keys_as_list(self):
        return list(self.__dict__)

    def set_event_id(self, event_id):
        self.event_id = event_id
    
    def set_label(self, label):
        self.label = label

    def set_system_time_created(self, system_time_created):
        self.system_time_created = system_time_created

    def set_event_record_id(self, event_record_id):
        self.event_record_id = event_record_id

    def get_event_record_id(self):
        return self.event_record_id